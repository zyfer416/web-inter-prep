{% extends "base.html" %}

{% block title %}Career Roadmap Generator - Web-Inter-Prep{% endblock %}

{% block content %}
<div class="hero-section bg-gradient-primary text-white py-5">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-4">Career Roadmap Generator</h1>
        <p class="lead mb-4">
            Generate a personalized career roadmap based on your role, experience, and target company using AI.
        </p>
    </div>
</div>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-body p-5">
                    <div class="text-center mb-4">
                        <i class="fas fa-route text-primary display-4 mb-3"></i>
                        <h3 class="card-title">Career Roadmap Generator</h3>
                        <p class="text-muted">Generate a personalized career roadmap based on your role, experience, and target company using AI.</p>
                    </div>
                    
                    <form id="roadmapForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="jobRole" class="form-label fw-bold">Job Role</label>
                                <select class="form-select" id="jobRole" required>
                                    <option value="">Select job role</option>
                                    <option value="software-engineer">Software Engineer</option>
                                    <option value="frontend-developer">Frontend Developer</option>
                                    <option value="backend-developer">Backend Developer</option>
                                    <option value="full-stack-developer">Full Stack Developer</option>
                                    <option value="devops-engineer">DevOps Engineer</option>
                                    <option value="data-scientist">Data Scientist</option>
                                    <option value="machine-learning-engineer">Machine Learning Engineer</option>
                                    <option value="qa-engineer">QA Engineer</option>
                                    <option value="product-manager">Product Manager</option>
                                    <option value="ux-ui-designer">UX/UI Designer</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="experience" class="form-label fw-bold">Years of Experience</label>
                                <select class="form-select" id="experience" required>
                                    <option value="">Select your experience</option>
                                    <option value="0-1">0-1 years</option>
                                    <option value="1-3">1-3 years</option>
                                    <option value="3-5">3-5 years</option>
                                    <option value="5-8">5-8 years</option>
                                    <option value="8+">8+ years</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="targetCompany" class="form-label fw-bold">Target Company</label>
                                <select class="form-select" id="targetCompany" required>
                                    <option value="any">Any (General)</option>
                                    <option value="google">Google</option>
                                    <option value="microsoft">Microsoft</option>
                                    <option value="amazon">Amazon</option>
                                    <option value="apple">Apple</option>
                                    <option value="meta">Meta</option>
                                    <option value="netflix">Netflix</option>
                                    <option value="ibm">IBM</option>
                                    <option value="oracle">Oracle</option>
                                    <option value="salesforce">Salesforce</option>
                                    <option value="adobe">Adobe</option>
                                    <option value="other">Other Specific Company</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="skills" class="form-label fw-bold">Key Skills (comma-separated)</label>
                                <input type="text" class="form-control" id="skills" placeholder="e.g., Python, React, SQL, AWS" required>
                            </div>
                        </div>
                        
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg px-5">
                                <i class="fas fa-magic me-2"></i>Generate Roadmap
                            </button>
                        </div>
                    </form>
                    
                    <!-- Roadmap Output Section (Hidden by default) -->
                    <div id="roadmapOutput" class="mt-5" style="display: none;">
                        <hr class="my-4">
                        <h4 class="text-center mb-4">Your Personalized Career Roadmap</h4>
                        
                        <div id="roadmapStages">
                            <!-- Roadmap content will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('roadmapForm').addEventListener('submit', function(e) {
    e.preventDefault();
    generateRoadmap();
});

function generateRoadmap() {
    const jobRole = document.getElementById('jobRole').value;
    const experience = document.getElementById('experience').value;
    const targetCompany = document.getElementById('targetCompany').value;
    const skills = document.getElementById('skills').value;
    
    if (!jobRole || !experience || !targetCompany || !skills) {
        alert('Please fill in all fields');
        return;
    }
    
    // Show loading state
    const submitBtn = document.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Generating...';
    submitBtn.disabled = true;
    
    // Call backend (Gemini)
    fetch('/api/roadmap', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ jobRole, experience, targetCompany, skills })
    })
    .then(r => r.json())
    .then(data => {
        if (data.error) {
            alert(data.error);
            return;
        }
        const roadmapOutput = document.getElementById('roadmapOutput');
        const roadmapStages = document.getElementById('roadmapStages');
        roadmapStages.innerHTML = data.html;
        roadmapOutput.style.display = 'block';
        roadmapOutput.scrollIntoView({ behavior: 'smooth' });
    })
    .catch(err => {
        alert('Failed to generate roadmap. Please try again.');
        console.error(err);
    })
    .finally(() => {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
    });
}
// Client-side generator removed in favor of server API
</script>
<style>
.ai-roadmap .stage-card .card-header{background:linear-gradient(90deg,#0d6efd,#6610f2)}
.ai-roadmap .stage-card .card-body{background:#0f1620;color:#e6edf3;border-radius:.25rem}
.ai-roadmap .stage-card ul{margin:0 0 .5rem 1rem}
.ai-roadmap .stage-card li{margin-bottom:.25rem}
.ai-roadmap .stage-card p{margin-bottom:.5rem}
</style>
{% endblock %} 